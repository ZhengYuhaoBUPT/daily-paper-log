Focus: FL    

# 📚 Table of Contents

[1. FedGPA: 面向边缘异常检测的全局-个性化联邦学习框架](#FedGPA-面向边缘异常检测的全局-个性化联邦学习框架)  



# FedGPA: 面向边缘异常检测的全局-个性化联邦学习框架  
&gt; 论文信息：IEEE INFOCOM 2025，福州大学 & 英国埃克塞特大学联合工作  
&gt; 作者：陈哲毅、薛龙翔、钟璐颖、闵革勇  
&gt; 中文精华总结

---

## 🏠 框架总览
<div align="center">
  <img src="./images/FedGPA.png" width="700" alt="FedGPA系统异构图">
  <p><em>图1：真实测试床设备拓扑</em></p>
</div>


&gt; 图是一张「一图读懂 FedGPA」的高清流程图，把整篇论文的核心机制浓缩成 3 条泳道、4 个关键模块和 1 个加速 trick。下面按“从上到下、从云到端”的顺序带你漫游。

---

### ① 顶层：边缘服务器（Edge Server）——“云侧 5 秒速成班”
- **输入**：上一轮的 `Wf`（特征提取器）+ `E`（类嵌入字典）+ `T`（条件映射网络）。
- **操作**：
  1. 按客户端数据量权重 `ni` 做聚合（Global aggregation）。
  2. 把新鲜出炉的全局三元组 `{Wf, E, T}` 打包成“学习资料包”，5 GHz Wi-Fi 一键群发。
- **输出**：全局模型，准备进入下一轮联邦循环。

---

### ② 中层：本地训练（Local Training）——“端侧双轨并行实验室”
每个异构客户端（Laptop｜Phone｜Drone 图标直观展示算力阶梯）拿到资料包后，在本地同时开启两条流水线：

| 流水线 | 输入 | 关键模块 | 输出 & 作用 |
|---|---|---|---|
| **Global Rail** | 原始流量 `X` → `X'` | FeT(`;T`) 条件变换 → `XG`&lt;br&gt;GCE(`Yi;E`) 对比-幅度损失 | 全局特征 `XG` 贴近“攻击共性”嵌入，解决 Non-IID |
| **Personal Rail** | 同一份 `X'` | FeT(`;T`) 条件变换 → `XP`&lt;br&gt;轻量头 `χ(;Wh)` + 交叉熵 | 个性化特征 `XP` 专注本地细分类，适配设备差异 |

&gt; 两条 rail 共享一个主干特征提取器 `Wf`，却通过 **条件参数 α/β** 实现“一份数据，两种表达”，这就是论文“Global-Personalized Collaboration”的可视化精髓。

---

### ③ 加速开关：Cosine-Sim 闸门——“慢节点救生圈”
- **计算**：`cosim(∇L_ce, ∇L_total)`，即“只用交叉熵”与“全损失”梯度的余弦相似度。
- **判断**：
  - 大于阈值 `γ`（默认 0.95）→ 闸门打开 `cs = 1`，下一轮直接 **用 L_ce 单损失更新**，省掉对比-幅度两项计算。
  - 否则继续全损失精调。
- **效果**：Jetson/Pi 这类“慢节点”训练时间 ↓30%+，但精度几乎不掉（论文表3 实证）。

---

### ④ 图标语言小贴士
- **箭头虚实**：实线表示“数据/特征流动”，虚线多指“控制信号/参数下载”。
- **彩色块**：
  - 绿色“Global model”块强调云侧共享；
  - 蓝/橙双箭头突出“双轨特征”；
  - 红色“cosim &gt; γ”判断框是整幅图最醒目的加速触发器。
- **设备剪影**：笔记本→高算力，手机→中等，无人机→资源最受限，一眼看出系统异构场景。

---

### 一句话总结
图2 用“云-边-端”纵向泳道把 FedGPA 的 **双特征变换→双损失协同→梯度闸门加速** 串成一条故事线：  
“边缘聚合共性，本地保留个性， cosine 闸门救慢节点”——三步走，解决统计+系统双异构。

## 1️⃣ 引言（Introduction）—— 为什么必须“全局+个性化”
- **业务痛点**
  - 5G/IoT 爆发式增长，终端数量激增，攻击面扩大 → 边缘侧实时异常检测成为刚需。
  - 传统云集中式检测：带宽消耗大、时延高、隐私泄露。
  - 移动边缘计算（MEC）下沉后，仍面临「数据孤岛」+「隐私泄露」双重困境。
- **联邦学习在边缘落地的两大新挑战**
  - 统计异构（Non-IID）：不同家庭、工厂、车载场景的攻击流量分布差异巨大。
  - 系统异构：Pi、Jetson、手机、无人机算力差距10×+，导致“慢节点”拖死全局聚合。
- **现有方案不足**
  - FedAvg：全局单一模型，无视节点差异，Non-IID 下精度跳水。
  - pFL（FedPer、FedALA 等）只做“个性化”却放弃“全局协同”，难以共享攻击模式共性。
- **本文立意**
  提出 FedGPA（Federated Learning with Global-Personalized Collaboration for Edge Anomaly Detection），首次在边缘异常检测里同时把「全局攻击共性」与「本地流量个性」做成可学习的双空间嵌入，并给出理论收敛保证。

---

## 2️⃣ 相关工作（Related Work）—— 前人踩过的坑
### 传统异常检测
- 浅层 ML（KNN、C4.5）→ 手工特征繁重。
- 深度 DL（1D-CNN、Bi-GRU、Transformer）→ 精度高但需集中原始流量，隐私一票否决。

### 联邦化异常检测
- 简单移植 FedAvg：Tian et al.、Bakopoulou et al.、Mosaiyebzadeh et al. 均默认 IID，真实边缘 Non-IID 下精度骤降。
- 个性化探索：GPFL、FedPer 把模型“切”成共享层+个性层，却忽视「慢节点」导致的聚合滞后。  
→ 结论：亟需“统计+系统”双异构一体化方案，FedGPA 由此出发。

---

## 3️⃣ FedGPA 框架详解（Method）
### 系统模型
- N 个 IoT 客户端，本地数据集 Di 非独立同分布，算力差异大。
- 每轮随机选客户端子集 Sr，下载三元组：{全局特征提取器 ψ，类嵌入 E，条件映射网络 T}。
- 本地训练后上传 {ψi, Ei, Ti}，边缘服务器做加权聚合，再下发下一轮。

### 核心创新 1：条件特征变换模块 FeT
- 把同一份流量字节流 X′ 同时映射为
  - 全局特征 X_G：捕捉跨设备共性攻击模式；
  - 个性化特征 X_P：保留本地私有流量习惯。
- 通过「条件输入」g / pi 动态生成映射参数 α, β，实现“一份数据，两条通路”。

### 核心创新 2：全局-类嵌入模块 GCE
- 维护可学习的类嵌入字典 E，每类异常（DoS、Mirai 等）都有对应向量。
- 引入对比损失 L_cl：让同类的 X_G 靠近、异类远离 → 提升全局判别力。
- 引入幅度损失 L_ml：让 X_G 逼近冻结的旧类嵌入，抑制噪声 → 稳定训练。
- 最终全局损失：L_g = L_cl + λ·L_ml。

### 核心创新 3：个性化头 + 交叉熵
- 仅对 X_P 使用轻量级 FC 头 χ，交叉熵 L_ce 负责本地细分类。
- 总损失 L_i,t = L_ce + L_cl + λ·L_ml，实现“共性+个性”端到端联合优化。

### 核心创新 4：梯度余弦相似度驱动的“损失替换”加速策略
- 每轮本地迭代 t&gt;1 时，计算  
  cos_sim(∇L_ce, ∇L_total)。
- 若相似度 &gt; 超参 γ（论文推荐 0.95），说明 L_ce 已能代表总体优化方向，直接用 L_ce 更新，舍去其余两项 → 慢节点省 30%+ 计算量，聚合等待时间显著缩短。
- 理论保证：替换后仍满足 L-光滑与强凸假设，收敛界不变（见第 4 章）。

### 算法流程（Algorithm 1）
1. 边缘端：初始化 ψ, E, T → 选客户端 → 加权聚合。
2. 客户端：
   - 接收全局三元组 → FeT 生成双路特征 → GCE 计算 L_cl & L_ml → χ 计算 L_ce。
   - 按 γ 策略决定“全损失”或“仅用 L_ce”更新。
   - 上传 {ψi, Ei, Ti}。
3. 重复 R 轮，输出每个客户端的个性化模型 {W_1…W_N}。

---

## 4️⃣ 理论分析（Convergence Analysis）
- 给出 5 条标准假设（有界梯度、L-光滑、μ-强凸等）。
- 推导三轮不等式，得到单轮递推关系：
E‖W_{r+1} - W_‖² ≤ (1 - Cμβ)‖W_r - W_‖² + Aβ


- 最终定理 1 证明：FedGPA 收敛速度为 O(1/R)，与是否启用“损失替换”无关，但后者常数更小 → 训练时间↓，精度不变。
→ 首次在边缘异构场景下给出 pFL 收敛界，填补空白。

---

## 5️⃣ 实验评估（Experiments）
### 真实测试床
- 边缘服务器：双 RTX3090，Xeon Silver。
- 客户端：10 台异构设备（Raspberry Pi 4B vs Jetson TX2），5 GHz Wi-Fi，Ubuntu 18.04。
→ 真实再现“算力墙”与“网络抖动”。

### 数据集
| 名称 | 攻击类型 | 备注 |
|---|---|---|
| ACI-IOT-2023 | Recon/DoS/BruteForce/Spoofing | 美陆军研究所，家庭 IoT |
| CIC-IOT-2023 | DDoS/Mirai/Spoofing | 加拿大 CIC，33 节点拓扑 |
| USTC-TFC-2016 | Virut/Neris/Htbot 等 10 类恶意 | 中科大，早期经典 |

- 按 Dirichlet(α=0.5) 采样 → 每客户端仅 60% 训练+20% 测试，重度 Non-IID。

### 对比基线
- 框架层：FedAvg / FedPer / FedALA / GPFL。
- 模型层：1D-CNN / GRU / Transformer 类 FormerTime。
- 统一超参：100 轮、本地 10 步、batch=64、lr=0.005、参与率 0.8。

### 主要结果
| 指标 | ACI-IoT | CIC-IoT | USTC-TFC |
|---|---|---|---|
| **最高精度** | 98.67% (1D-CNN) | 97.83% (1D-CNN) | 96.04% (1D-CNN) |
| **训练时间** | 13.77 s | 5.47 s | 4.73 s |
| **较 GPFL 提速** | ≈ 40% | ≈ 34% | ≈ 30% |
| **较 FedAvg 精度提升** | +2.31 pp | +19.05 pp | +5.39 pp |

-  scalability：客户端数从 10 增至 50，FedGPA 精度波动 < 9%，其余方法 17%–43%。
- 收敛曲线：前 30 轮即达到最低损失，稳定且平滑。
- 参数敏感：γ=0.95 时取得“精度-时间”帕累托最优。

---

## 6️⃣ 结论（Conclusion）
- 提出首个同时治理“统计+系统”双异构的边缘异常检测联邦框架 FedGPA。
- 技术三把斧：FeT 双路特征、GCE 对比-幅度损失、梯度余弦损失替换。
- 理论证明收敛性；真实测试床+三大流量集验证：同等精度下训练时间缩短 30–40%，同等时间下精度提升 2–19 个百分点。
- 未来工作
  - 面向芯片级异构（ARM/RISC-V/FPGA）做自动算子裁剪；
  - 引入差分隐私+安全聚合，抵御恶意客户端；
  - 探索在线增量模式，应对零日攻击漂移。

---

## 一句话提炼
FedGPA 让“慢”节点也能快速共享全球攻击知识，同时保留本地流量个性，真正做到“全局共性不丢失，本地个性不妥协”。